//
//  PCPokemonSystemDialogOverworldFlowState.h
//  ProjectRetro
//
//  Created by Alex Koukoulas on 01/10/2019.
//

////////////////////////////////////////////////////////////////////////////////////
////////////////////////////////////////////////////////////////////////////////////
////////////////////////////////////////////////////////////////////////////////////

#ifndef PCPokemonSystemDialogOverworldFlowState_h
#define PCPokemonSystemDialogOverworldFlowState_h

////////////////////////////////////////////////////////////////////////////////////
////////////////////////////////////////////////////////////////////////////////////
////////////////////////////////////////////////////////////////////////////////////

#include "BaseFlowState.h"
#include "../../common/utils/MathUtils.h"

#include <memory>
#include <string>
#include <vector>

////////////////////////////////////////////////////////////////////////////////////
////////////////////////////////////////////////////////////////////////////////////
////////////////////////////////////////////////////////////////////////////////////

struct Pokemon;

////////////////////////////////////////////////////////////////////////////////////
////////////////////////////////////////////////////////////////////////////////////
////////////////////////////////////////////////////////////////////////////////////

class PCPokemonSystemDialogOverworldFlowState final: public BaseFlowState
{
public:
    PCPokemonSystemDialogOverworldFlowState(ecs::World&);
    
    void VUpdate(const float dt) override;
    
private:
    static const glm::vec3 RELEASE_YES_NO_TEXTBOX_POSITION;

    static const float OVERLAID_CHATBOX_Z;
    static const float SECOND_OVERLAID_CHATBOX_Z;

    void UpdatePokemonSystemOptionsDialog();
    void UpdatePokemonListDialog(const float dt);
    void UpdatePokemonSelectedOptionsDialog();
    void UpdateReleaseExplanationText();
    void UpdateReleaseWaitForPokemonCry();
    void UpdateReleaseWaitForGoodByeText();
    void UpdateWaitForOptionFailureText();
    void UpdateWaitForPokemonCry();
    void UpdateWaitForOperationConfirmationFlow();
    void CreateAndPopulatePokemonList(const std::vector<std::unique_ptr<Pokemon>>&, const int itemMenuOffsetFromStart = 0, const int previousCursorRow = 0);
    void RedrawPokemonList(const std::vector<std::unique_ptr<Pokemon>>&);
    void DisplayPokemonListForCurrentOffset(const std::vector<std::unique_ptr<Pokemon>>&);
    void SaveLastFramesCursorRow();
    const std::vector<std::unique_ptr<Pokemon>>& GetActivePokemonCollectionForCurrentOperation() const;

};

////////////////////////////////////////////////////////////////////////////////////
////////////////////////////////////////////////////////////////////////////////////
////////////////////////////////////////////////////////////////////////////////////

#endif /* PCPokemonSystemDialogOverworldFlowState_h */
