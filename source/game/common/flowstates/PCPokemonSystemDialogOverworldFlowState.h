//
//  PCPokemonSystemDialogOverworldFlowState.h
//  ProjectRetro
//
//  Created by Alex Koukoulas on 01/10/2019.
//

////////////////////////////////////////////////////////////////////////////////////
////////////////////////////////////////////////////////////////////////////////////
////////////////////////////////////////////////////////////////////////////////////

#ifndef PCPokemonSystemDialogOverworldFlowState_h
#define PCPokemonSystemDialogOverworldFlowState_h

////////////////////////////////////////////////////////////////////////////////////
////////////////////////////////////////////////////////////////////////////////////
////////////////////////////////////////////////////////////////////////////////////

#include "BaseFlowState.h"

#include <memory>
#include <string>
#include <vector>

////////////////////////////////////////////////////////////////////////////////////
////////////////////////////////////////////////////////////////////////////////////
////////////////////////////////////////////////////////////////////////////////////

struct Pokemon;

////////////////////////////////////////////////////////////////////////////////////
////////////////////////////////////////////////////////////////////////////////////
////////////////////////////////////////////////////////////////////////////////////

class PCPokemonSystemDialogOverworldFlowState final: public BaseFlowState
{
public:
    PCPokemonSystemDialogOverworldFlowState(ecs::World&);
    
    void VUpdate(const float dt) override;
    
private:
    static const float OVERLAID_CHATBOX_Z;

    enum class PokemonSystemState
    {
        OPTIONS, POKEMON_LIST, SELECTED_POKEMON_OPTIONS
    };

    enum class PokemonSystemOperationType
    {
        WITHDRAW, DEPOSIT, RELEASE
    };

    void UpdatePokemonSystemOptionsDialog(const float dt);
    void UpdatePokemonListDialog(const float dt);
    void UpdatePokemonSelectedOptionsDialog(const float dt);
    void CreateAndPopulatePokemonList(const std::vector<std::unique_ptr<Pokemon>>&);
    void RedrawPokemonList(const std::vector<std::unique_ptr<Pokemon>>&);
    void DisplayPokemonListForCurrentOffset(const std::vector<std::unique_ptr<Pokemon>>&);
    void SaveLastFramesCursorRow();

    PokemonSystemState mPokemonSystemState;
    PokemonSystemOperationType mPokemonSystemOperationType;
};

////////////////////////////////////////////////////////////////////////////////////
////////////////////////////////////////////////////////////////////////////////////
////////////////////////////////////////////////////////////////////////////////////

#endif /* PCPokemonSystemDialogOverworldFlowState_h */
