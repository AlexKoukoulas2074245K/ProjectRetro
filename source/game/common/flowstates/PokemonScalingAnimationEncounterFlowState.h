//
//  PokemonScalingAnimationEncounterFlowState.h
//  ProjectRetro
//
//  Created by Alex Koukoulas on 29/07/2019.
//

////////////////////////////////////////////////////////////////////////////////////
////////////////////////////////////////////////////////////////////////////////////
////////////////////////////////////////////////////////////////////////////////////

#ifndef PokemonScalingAnimationEncounterFlowState_h
#define PokemonScalingAnimationEncounterFlowState_h

////////////////////////////////////////////////////////////////////////////////////
////////////////////////////////////////////////////////////////////////////////////
////////////////////////////////////////////////////////////////////////////////////

#include "BaseFlowState.h"
#include "../../ECS.h"
#include "../../common/utils/MathUtils.h"

#include <string>

////////////////////////////////////////////////////////////////////////////////////
////////////////////////////////////////////////////////////////////////////////////
////////////////////////////////////////////////////////////////////////////////////

class PokemonScalingAnimationEncounterFlowState final: public BaseFlowState
{
public:
    PokemonScalingAnimationEncounterFlowState(ecs::World&);
    
    void VUpdate(const float dt) override;
   
private:
    void OnScaleUpFinished();
    void OnScaleDownFinished();
    void RepopulateScalingBlockEntities();
    ecs::EntityId CreateScalingBlockEntity
    (
        const std::string atlasPath,
        const bool isOpponentsPokemonSprite,
        const int colWRTOriginBlock,
        const int rowWRTOriginBlock,
        const int atlasCol,
        const int atlasRow
    );

    static const glm::vec3 PLAYERS_POKEMON_SCALE_ORIGIN_BLOCK_POSITION;
    static const glm::vec3 OPPONENTS_POKEMON_SCALE_ORIGIN_BLOCK_POSITION;

    static const int INDIVIDUAL_POKEMON_SPRITE_ATLAS_COLS;
    static const int INDIVIDUAL_POKEMON_SPRITE_ATLAS_ROWS;

    static const float SCALING_STEP_DURATION;
    static const float SPRITE_FINAL_SCALE;
};

////////////////////////////////////////////////////////////////////////////////////
////////////////////////////////////////////////////////////////////////////////////
////////////////////////////////////////////////////////////////////////////////////

#endif /* PokemonDeathTextEncounterFlowState_h */
