//
//  NoPPLeftTextEncounterFlowState.cpp
//  ProjectRetro
//
//  Created by Alex Koukoulas on 02/08/2019.
//

////////////////////////////////////////////////////////////////////////////////////
////////////////////////////////////////////////////////////////////////////////////
////////////////////////////////////////////////////////////////////////////////////

#include "NoPPLeftTextEncounterFlowState.h"
#include "FightMenuEncounterFlowState.h"
#include "../components/GuiStateSingletonComponent.h"
#include "../utils/TextboxUtils.h"

////////////////////////////////////////////////////////////////////////////////////
////////////////////////////////////////////////////////////////////////////////////
////////////////////////////////////////////////////////////////////////////////////

const float NoPPLeftTextEncounterFlowState::NO_PP_LEFT_TEXT_Z = -0.5f;

////////////////////////////////////////////////////////////////////////////////////
////////////////////////////////////////////////////////////////////////////////////
////////////////////////////////////////////////////////////////////////////////////

NoPPLeftTextEncounterFlowState::NoPPLeftTextEncounterFlowState(ecs::World& world)
    : BaseFlowState(world)
{
    const auto noPPLeftChatboxEntityId = CreateChatbox(mWorld, glm::vec3(CHATBOX_POSITION.x, CHATBOX_POSITION.y, NO_PP_LEFT_TEXT_Z));
    QueueDialogForChatbox(noPPLeftChatboxEntityId, "No PP left for#this move!#+END", mWorld);
}

void NoPPLeftTextEncounterFlowState::VUpdate(const float)
{
    const auto& guiStateComponent = mWorld.GetSingletonComponent<GuiStateSingletonComponent>();               
    if (guiStateComponent.mActiveTextboxesStack.size() == 2)
    {
        CompleteAndTransitionTo<FightMenuEncounterFlowState>();
    }
}

////////////////////////////////////////////////////////////////////////////////////
////////////////////////////////////////////////////////////////////////////////////
////////////////////////////////////////////////////////////////////////////////////

