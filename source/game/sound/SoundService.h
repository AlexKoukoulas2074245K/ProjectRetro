//
//  SoundService.h
//  ProjectRetro
//
//  Created by Alex Koukoulas on 29/08/2019.
//


////////////////////////////////////////////////////////////////////////////////////
////////////////////////////////////////////////////////////////////////////////////
////////////////////////////////////////////////////////////////////////////////////

#ifndef SoundService_h
#define SoundService_h

#include "../common/utils/StringUtils.h"

////////////////////////////////////////////////////////////////////////////////////
////////////////////////////////////////////////////////////////////////////////////
////////////////////////////////////////////////////////////////////////////////////

using MusicResourceId = unsigned int;

////////////////////////////////////////////////////////////////////////////////////
////////////////////////////////////////////////////////////////////////////////////
////////////////////////////////////////////////////////////////////////////////////

class SoundService final
{    
    friend class App;

public:
    static SoundService& GetInstance();

    ~SoundService();
    SoundService(const SoundService&) = delete;
    SoundService(SoundService&&) = delete;
    const SoundService& operator = (const SoundService&) = delete;
    SoundService& operator = (SoundService&&) = delete;

    void InitializeSdlMixer() const;
    
    void PlayMusic(const StringId musicTrackName);

    void OnMusicFinished();

private:    
    SoundService() = default;    
    
    static const std::string MUSIC_FILE_EXTENSION;
    
    static const int SOUND_FREQUENCY;
    static const int HARDWARE_CHANNELS;
    static const int CHUNK_SIZE_IN_BYTES;
    static const int FADE_OUT_DURATION_IN_MILISECONDS;

    MusicResourceId mCurrentlyPlayingMusicResourceId = 0;
    MusicResourceId mQueuedMusicResourceId = 0;
};

////////////////////////////////////////////////////////////////////////////////////
////////////////////////////////////////////////////////////////////////////////////
////////////////////////////////////////////////////////////////////////////////////

#endif /* SoundService_h */
