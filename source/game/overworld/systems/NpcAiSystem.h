//
//  NpcAiSystem.h
//  ProjectRetro
//
//  Created by Alex Koukoulas on 03/05/2019.
//

////////////////////////////////////////////////////////////////////////////////////
////////////////////////////////////////////////////////////////////////////////////
////////////////////////////////////////////////////////////////////////////////////

#ifndef NpcAiSystemSystem_h
#define NpcAiSystemSystem_h

////////////////////////////////////////////////////////////////////////////////////
////////////////////////////////////////////////////////////////////////////////////
////////////////////////////////////////////////////////////////////////////////////

#include "../../ECS.h"

#include <string>

////////////////////////////////////////////////////////////////////////////////////
////////////////////////////////////////////////////////////////////////////////////
////////////////////////////////////////////////////////////////////////////////////

class NpcAiSystem final: public ecs::BaseSystem
{
public:
    NpcAiSystem(ecs::World&);
    
    void VUpdateAssociatedComponents(const float dt) const override;
    
private:
    void UpdateTrainerNpc(const float dt, const ecs::EntityId) const;
    void UpdateStationaryNpc(const float dt, const ecs::EntityId) const;
    void UpdateDynamicNpc(const float dt, const ecs::EntityId) const;
    void StartEncounter(const ecs::EntityId) const;
    void CheckForPlayerDistanceAndEncounterEngagement(const ecs::EntityId npcEntityId) const;
    void CreateExclamationMarkEntity(const ecs::EntityId npcEntityId) const;
    void DestroyExclamationMarkEntity(const ecs::EntityId npcEntityId) const;
    
    static const std::string TRAINER_BATTLE_MAIN_MUSIC_TRACK_NAME;
    static const std::string GYM_BATTLE_MAIN_MUSIC_TRACK_NAME;

    static const float DYNAMIC_NPC_MIN_MOVEMENT_INITIATION_TIME;
    static const float DYNAMIC_NPC_MAX_MOVEMENT_INITIATION_TIME;
    static const float STATIONARY_NPC_RESET_TIME;
    static const float EXCLAMATION_MARK_LIFE_TIME;
    
    static const int TRAINER_LINE_OF_SIGHT;
    static const int EXCLAMATION_MARK_ATLAS_COL;
    static const int EXCLAMATION_MARK_ATLAS_ROW;
};

////////////////////////////////////////////////////////////////////////////////////
////////////////////////////////////////////////////////////////////////////////////
////////////////////////////////////////////////////////////////////////////////////

#endif /* NpcAiSystemSystem_h */
